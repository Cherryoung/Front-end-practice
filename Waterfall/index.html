<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>瀑布流</title>
    <style>
    html,
    body {
        background-color: #ccc;
        padding: 0;
        margin: 0;
    }

    #war {
        margin: 0 auto;
    }

    .img {
        width: 210px;
        /*实际宽度220px*/
        float: left;
        padding: 5px;
    }

    .img img {
        width: 200px;
        background: #fff;
        padding: 5px;
    }
    </style>
</head>

<body>
    <div id="war">
        <div class="img"><img src="../plan/again.png" /></div>
        <div class="img"><img src="../plan/bg.png" /></div>
        <div class="img"><img src="../plan/bj.png" /></div>
        <div class="img"><img src="../plan/btn.png" /></div>
        <div class="img"><img src="../plan/person.png" /></div>
        <div class="img"><img src="../plan/person1.png" /></div>
        <div class="img"><img src="../plan/plan-sign.png" /></div>
        <div class="img"><img src="../plan/runing-01.png" /></div>
        <div class="img"><img src="../plan/runing_02.png" /></div>
        <div class="img"><img src="../plan/running-sign_03.png" /></div>
        <div class="img"><img src="../plan/sigin-btn-a.png" /></div>
        <div class="img"><img src="../plan/sign-btn-m.png" /></div>
        <div class="img"><img src="../plan/sign-c.png" /></div>
        <div class="img"><img src="../plan/sign-e.png" /></div>
    </div>
    <script>
    window.onload = function() {
        var oImg = document.getElementsByClassName('img');
        var oWar = document.getElementById('war');

        set(oWar, oImg);
    };

    //瀑布流设置
    var set = function(war, box) {
        war.style.position = 'relative';

        var nCount = parseInt(getWinSize().w / 220);

        war.style.width = nCount * 220 + 'px';
        var aHeight = getColHeight(box, nCount);

        for (var i = nCount; i < box.length; i++) {
            var nMinHeight = Math.min.apply(null, aHeight);
            var nColumn = getColumn(aHeight, nMinHeight);

            box[i].style.position = 'absolute';
            box[i].style.left = nColumn * 220 + 'px';
            box[i].style.top = nMinHeight + 'px';
            aHeight[nColumn] = nMinHeight * 1 + box[i].offsetHeight;
        }
    };

    //寻找高度对应的列
    var getColumn = function(arr, height) {
        for (var j = 0; j < arr.length; j++) {
            if (arr[j] == height)
                return j;
        }
    };

    //获取第一行每列高度
    var getColHeight = function(element, num) {
        var aHeightArr = [];
        for (var i = 0; i < num; i++) {
            aHeightArr.push(element[i].offsetHeight);
        }
        return aHeightArr;
    };

    //获取节点大小
    var getNodeSize = function(element) {
        return {
            w: element.offsetWidth,
            h: element.offsetHeight
        };
    };

    //获取窗口大小
    var getWinSize = function(w) {
        var w = w || window;
        if (w.innerWidth != null)
            return {
                w: w.innerWidth,
                h: w.innerHeight
            };

        var d = w.document;
        if (document.compatMode == 'CSS1compat')
            return {
                w: d.documentElement.clientWidth,
                h: d.documentElement.clientHeight
            };

        return {
            w: d.body.clientWidth,
            h: d.body.clientHeight
        };
    };
    </script>
</body>

</html>
